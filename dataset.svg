<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1138px" preserveAspectRatio="none" style="width:1746px;height:1138px;" version="1.1" viewBox="0 0 1746 1138" width="1746px" zoomAndPan="magnify"><defs><filter height="300%" id="fe0njc3egirjq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class Object--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="123.1147" id="Object" style="stroke: #383838; stroke-width: 1.5;" width="167" x="1133.5" y="8"/><ellipse cx="1195.25" cy="24" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1194.9375,30 Q1193,30 1191.875,28.5703 Q1190.75,27.1406 1190.75,24.1875 Q1190.75,21.6875 1191.9375,20 Q1193.125,18.3125 1195.1875,18.3125 Q1195.6406,18.3125 1196.0781,18.3125 Q1196.5156,18.3125 1196.8281,18.3125 Q1197.0781,18.3125 1197.2422,18.3125 Q1197.4063,18.3125 1197.8125,18.3125 L1198.5156,22 L1197.4531,22 Q1197.0156,20.9063 1196.4453,20.4531 Q1195.875,20 1194.9531,20 Q1193.7969,20 1193.1172,21.1797 Q1192.4375,22.3594 1192.4375,24.1875 Q1192.4375,26.2031 1192.9609,27.2578 Q1193.4844,28.3125 1194.8906,28.3125 Q1195.8125,28.3125 1196.4609,27.7422 Q1197.1094,27.1719 1197.4531,25.7813 L1198.4844,26.2969 Q1198.0938,28.0469 1197.1563,29.0234 Q1196.2188,30 1194.9375,30 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="1215.75" y="29.5576">Object</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1134.5" x2="1299.5" y1="40" y2="40"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="155" x="1139.5" y="56.606">Parent class of all other classes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="1139.5" y="90.6519">(buitin)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1134.5" x2="1207" y1="70.5344" y2="70.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1207" y="75.1289">field</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1227" x2="1299.5" y1="70.5344" y2="70.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1139.5" y="124.6978">(builtin)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1134.5" x2="1199.5" y1="104.5803" y2="104.5803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1199.5" y="109.1748">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1234.5" x2="1299.5" y1="104.5803" y2="104.5803"/><!--class Dataset--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="138.1377" id="Dataset" style="stroke: #383838; stroke-width: 1.5;" width="186" x="385" y="213.5"/><ellipse cx="452.75" cy="229.5" fill="#CDCDCD" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M453.8281,230.5 L451.0156,230.5 L450.2031,232.1094 Q450.1563,232.2656 450.1563,232.4063 Q450.1563,232.5938 450.2031,232.7031 Q450.25,232.8125 450.4688,232.8125 L451.0156,232.8125 L451.0156,234.5 L447.75,234.5 L447.75,232.8125 L448.3125,232.8125 Q448.5313,232.8125 448.6484,232.75 Q448.7656,232.6875 448.8125,232.5 L451.9063,222.8125 L453.2813,222.8125 L456.3125,232.3906 Q456.4063,232.625 456.5469,232.7188 Q456.6875,232.8125 456.875,232.8125 L457.4375,232.8125 L457.4375,234.5 L453.7813,234.5 L453.7813,232.8125 L454.3906,232.8125 Q454.5625,232.8125 454.5703,232.7969 Q454.5781,232.7813 454.5781,232.7188 Q454.5781,232.5469 454.5469,232.4531 L453.8281,230.5 Z M448.6094,233.5 L448.6094,233.5 Z M449.2813,233.5 L449.2813,233.5 Z M454,233.5 L454,233.5 Z M455.125,233.5 L455.125,233.5 Z M452.3281,224.9063 L452.4063,224.9063 L451.5469,228.8125 L453.5,228.8125 L452.3281,224.9063 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="42" x="473.25" y="235.0576">Dataset</text><line style="stroke: #383838; stroke-width: 1.5;" x1="386" x2="570" y1="245.5" y2="245.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="391" y="262.106">The whole data will be exposed to it</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="394" y="296.1519"/><line style="stroke: #383838; stroke-width: 1.0;" x1="386" x2="468" y1="276.0344" y2="276.0344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="468" y="280.6289">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="488" x2="570" y1="276.0344" y2="276.0344"/><polygon fill="#EAEAEA" points="396,321.6033,400,325.6033,396,329.6033,392,325.6033" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="405" y="330.1978">__init__()</text><polygon fill="#EAEAEA" points="396,336.6262,400,340.6262,396,344.6262,392,340.6262" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="405" y="345.2207">__getitem__(*input)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="386" x2="460.5" y1="310.0803" y2="310.0803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="460.5" y="314.6748">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="495.5" x2="570" y1="310.0803" y2="310.0803"/><!--class Sampler--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="183.2065" id="Sampler" style="stroke: #383838; stroke-width: 1.5;" width="255" x="848.5" y="191"/><ellipse cx="948.25" cy="207" fill="#CDCDCD" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M949.3281,208 L946.5156,208 L945.7031,209.6094 Q945.6563,209.7656 945.6563,209.9063 Q945.6563,210.0938 945.7031,210.2031 Q945.75,210.3125 945.9688,210.3125 L946.5156,210.3125 L946.5156,212 L943.25,212 L943.25,210.3125 L943.8125,210.3125 Q944.0313,210.3125 944.1484,210.25 Q944.2656,210.1875 944.3125,210 L947.4063,200.3125 L948.7813,200.3125 L951.8125,209.8906 Q951.9063,210.125 952.0469,210.2188 Q952.1875,210.3125 952.375,210.3125 L952.9375,210.3125 L952.9375,212 L949.2813,212 L949.2813,210.3125 L949.8906,210.3125 Q950.0625,210.3125 950.0703,210.2969 Q950.0781,210.2813 950.0781,210.2188 Q950.0781,210.0469 950.0469,209.9531 L949.3281,208 Z M944.1094,211 L944.1094,211 Z M944.7813,211 L944.7813,211 Z M949.5,211 L949.5,211 Z M950.625,211 L950.625,211 Z M947.8281,202.4063 L947.9063,202.4063 L947.0469,206.3125 L949,206.3125 L947.8281,202.4063 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="968.75" y="212.5576">Sampler</text><line style="stroke: #383838; stroke-width: 1.5;" x1="849.5" x2="1102.5" y1="223" y2="223"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="854.5" y="239.606">A generator of mini-batch</text><polygon fill="none" points="859.5,265.0574,863.5,269.0574,859.5,273.0574,855.5,269.0574" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="868.5" y="273.6519">dataset</text><polygon fill="none" points="859.5,280.0803,863.5,284.0803,859.5,288.0803,855.5,284.0803" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="868.5" y="288.6748">mode</text><polygon fill="none" points="859.5,295.1033,863.5,299.1033,859.5,303.1033,855.5,299.1033" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="868.5" y="303.6978">batch_size</text><line style="stroke: #383838; stroke-width: 1.0;" x1="849.5" x2="966" y1="253.5344" y2="253.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="966" y="258.1289">field</text><line style="stroke: #383838; stroke-width: 1.0;" x1="986" x2="1102.5" y1="253.5344" y2="253.5344"/><polygon fill="#EAEAEA" points="859.5,329.1492,863.5,333.1492,859.5,337.1492,855.5,333.1492" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="868.5" y="337.7437">__init__(dataset, batch_size, mini_batch_size)</text><ellipse cx="859.5" cy="349.1721" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="868.5" y="352.7666">__next__()</text><ellipse cx="859.5" cy="364.1951" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="868.5" y="367.7896">sample_by_idx(scaffold_id, mol_id, batch_size)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="849.5" x2="958.5" y1="317.6262" y2="317.6262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="958.5" y="322.2207">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="993.5" x2="1102.5" y1="317.6262" y2="317.6262"/><!--class Transformer--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="123.1147" id="Transformer" style="stroke: #383838; stroke-width: 1.5;" width="157" x="1138.5" y="221"/><ellipse cx="1179.6" cy="237" fill="#CDCDCD" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1180.6781,238 L1177.8656,238 L1177.0531,239.6094 Q1177.0063,239.7656 1177.0063,239.9063 Q1177.0063,240.0938 1177.0531,240.2031 Q1177.1,240.3125 1177.3188,240.3125 L1177.8656,240.3125 L1177.8656,242 L1174.6,242 L1174.6,240.3125 L1175.1625,240.3125 Q1175.3813,240.3125 1175.4984,240.25 Q1175.6156,240.1875 1175.6625,240 L1178.7563,230.3125 L1180.1313,230.3125 L1183.1625,239.8906 Q1183.2563,240.125 1183.3969,240.2188 Q1183.5375,240.3125 1183.725,240.3125 L1184.2875,240.3125 L1184.2875,242 L1180.6313,242 L1180.6313,240.3125 L1181.2406,240.3125 Q1181.4125,240.3125 1181.4203,240.2969 Q1181.4281,240.2813 1181.4281,240.2188 Q1181.4281,240.0469 1181.3969,239.9531 L1180.6781,238 Z M1175.4594,241 L1175.4594,241 Z M1176.1313,241 L1176.1313,241 Z M1180.85,241 L1180.85,241 Z M1181.975,241 L1181.975,241 Z M1179.1781,232.4063 L1179.2563,232.4063 L1178.3969,236.3125 L1180.35,236.3125 L1179.1781,232.4063 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="67" x="1199.4" y="242.5576">Transformer</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1139.5" x2="1294.5" y1="253" y2="253"/><polygon fill="none" points="1149.5,280.0344,1153.5,284.0344,1149.5,288.0344,1145.5,284.0344" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="1158.5" y="288.6289">data</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1139.5" x2="1207" y1="268.5115" y2="268.5115"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1207" y="273.106">field</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1227" x2="1294.5" y1="268.5115" y2="268.5115"/><polygon fill="#EAEAEA" points="1149.5,314.0803,1153.5,318.0803,1149.5,322.0803,1145.5,318.0803" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="1158.5" y="322.6748">mol_to_array(smiles)</text><polygon fill="#EAEAEA" points="1149.5,329.1033,1153.5,333.1033,1149.5,337.1033,1145.5,333.1033" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="131" x="1158.5" y="337.6978">batch_to_array(smiles_list)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1139.5" x2="1199.5" y1="302.5574" y2="302.5574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1199.5" y="307.1519">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1234.5" x2="1294.5" y1="302.5574" y2="302.5574"/><!--class Block--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="153.1606" id="Block" style="stroke: #383838; stroke-width: 1.5;" width="191" x="1330.5" y="206"/><ellipse cx="1406.75" cy="222" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1406.4375,228 Q1404.5,228 1403.375,226.5703 Q1402.25,225.1406 1402.25,222.1875 Q1402.25,219.6875 1403.4375,218 Q1404.625,216.3125 1406.6875,216.3125 Q1407.1406,216.3125 1407.5781,216.3125 Q1408.0156,216.3125 1408.3281,216.3125 Q1408.5781,216.3125 1408.7422,216.3125 Q1408.9063,216.3125 1409.3125,216.3125 L1410.0156,220 L1408.9531,220 Q1408.5156,218.9063 1407.9453,218.4531 Q1407.375,218 1406.4531,218 Q1405.2969,218 1404.6172,219.1797 Q1403.9375,220.3594 1403.9375,222.1875 Q1403.9375,224.2031 1404.4609,225.2578 Q1404.9844,226.3125 1406.3906,226.3125 Q1407.3125,226.3125 1407.9609,225.7422 Q1408.6094,225.1719 1408.9531,223.7813 L1409.9844,224.2969 Q1409.5938,226.0469 1408.6563,227.0234 Q1407.7188,228 1406.4375,228 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="30" x="1427.25" y="227.5576">Block</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1331.5" x2="1520.5" y1="238" y2="238"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="1336.5" y="254.606">A subclass of int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="179" x="1336.5" y="269.6289">Performs the id of a block of samples</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1338.5" y="297.0803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1350.5" y="303.6748">num</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1331.5" x2="1416" y1="283.5574" y2="283.5574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1416" y="288.1519">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1436" x2="1520.5" y1="283.5574" y2="283.5574"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1338.5" y="331.1262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1350.5" y="337.7207">__init__(block_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1338.5" y="346.1492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="1350.5" y="352.7437">__repr__()</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1331.5" x2="1408.5" y1="317.6033" y2="317.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1408.5" y="322.1978">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1443.5" x2="1520.5" y1="317.6033" y2="317.6033"/><!--class ExcludeBlock--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="183.2065" id="ExcludeBlock" style="stroke: #383838; stroke-width: 1.5;" width="179" x="1556.5" y="191"/><ellipse cx="1605.25" cy="207" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1604.9375,213 Q1603,213 1601.875,211.5703 Q1600.75,210.1406 1600.75,207.1875 Q1600.75,204.6875 1601.9375,203 Q1603.125,201.3125 1605.1875,201.3125 Q1605.6406,201.3125 1606.0781,201.3125 Q1606.5156,201.3125 1606.8281,201.3125 Q1607.0781,201.3125 1607.2422,201.3125 Q1607.4063,201.3125 1607.8125,201.3125 L1608.5156,205 L1607.4531,205 Q1607.0156,203.9063 1606.4453,203.4531 Q1605.875,203 1604.9531,203 Q1603.7969,203 1603.1172,204.1797 Q1602.4375,205.3594 1602.4375,207.1875 Q1602.4375,209.2031 1602.9609,210.2578 Q1603.4844,211.3125 1604.8906,211.3125 Q1605.8125,211.3125 1606.4609,210.7422 Q1607.1094,210.1719 1607.4531,208.7813 L1608.4844,209.2969 Q1608.0938,211.0469 1607.1563,212.0234 Q1606.2188,213 1604.9375,213 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="1625.75" y="212.5576">ExcludeBlock</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1557.5" x2="1734.5" y1="223" y2="223"/><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="252.0344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="1576.5" y="258.6289">block_id</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="267.0574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="2" x="1576.5" y="273.6519">i</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="282.0803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="24" x="1576.5" y="288.6748">ls_all</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1557.5" x2="1636" y1="238.5115" y2="238.5115"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1636" y="243.106">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1656" x2="1734.5" y1="238.5115" y2="238.5115"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="316.1262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="1576.5" y="322.7207">__init__(block_id, num_block=5)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="331.1492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="1576.5" y="337.7437">__repr__()</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="346.1721"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="1576.5" y="352.7666">__iter__()</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1564.5" y="361.1951"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="1576.5" y="367.7896">__next__()</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1557.5" x2="1628.5" y1="302.6033" y2="302.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1628.5" y="307.1978">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1663.5" x2="1734.5" y1="302.6033" y2="302.6033"/><!--class SQLDataset--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="693.9868" id="SQLDataset" style="stroke: #383838; stroke-width: 1.5;" width="346" x="6" y="434"/><ellipse cx="141.25" cy="450" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M140.9375,456 Q139,456 137.875,454.5703 Q136.75,453.1406 136.75,450.1875 Q136.75,447.6875 137.9375,446 Q139.125,444.3125 141.1875,444.3125 Q141.6406,444.3125 142.0781,444.3125 Q142.5156,444.3125 142.8281,444.3125 Q143.0781,444.3125 143.2422,444.3125 Q143.4063,444.3125 143.8125,444.3125 L144.5156,448 L143.4531,448 Q143.0156,446.9063 142.4453,446.4531 Q141.875,446 140.9531,446 Q139.7969,446 139.1172,447.1797 Q138.4375,448.3594 138.4375,450.1875 Q138.4375,452.2031 138.9609,453.2578 Q139.4844,454.3125 140.8906,454.3125 Q141.8125,454.3125 142.4609,453.7422 Q143.1094,453.1719 143.4531,451.7813 L144.4844,452.2969 Q144.0938,454.0469 143.1563,455.0234 Q142.2188,456 140.9375,456 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="161.75" y="455.5576">SQLDataset</text><line style="stroke: #383838; stroke-width: 1.5;" x1="7" x2="351" y1="466" y2="466"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="12" y="482.606">A mysql Dataset class</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="510.0574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="26" y="516.6519">db</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="525.0803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="26" y="531.6748">scaffold_table</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="540.1033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="26" y="546.6978">mol_table</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="555.1262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="26" y="561.7207">map_table</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="570.1492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="26" y="576.7437">num_mol</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="585.1721"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="26" y="591.7666">num_scaffold</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="600.1951"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="26" y="606.7896">num_map</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="615.218"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="320" x="26" y="621.8125">sc_fold 'dict {block_id:[mol,mol]} 直接初始时运行好，只花一次时间</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="630.241"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="26" y="636.8354">mol_fold 'dict {block_id:[mol, mol]}</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="645.2639"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="26" y="651.8584">num_fold=5 '预置fold数</text><line style="stroke: #383838; stroke-width: 1.0;" x1="7" x2="169" y1="496.5344" y2="496.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="169" y="501.1289">field</text><line style="stroke: #383838; stroke-width: 1.0;" x1="189" x2="351" y1="496.5344" y2="496.5344"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="679.3098"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="290" x="26" y="685.9043">__init__(mysql_param, scaffold_table, mol_table, map_table)</text><ellipse cx="17" cy="697.3328" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="268" x="26" y="700.9272">ls_to_str(list) '把传入的列表转为'(int,int...)'的字符串形式</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="709.3557"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="26" y="715.9502">__getitem__(scaffold_id, mol_id) '对应5*5=25种索引方式</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="29" y="730.9731"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="739.4016"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="26" y="745.9961">_get_item_block_block(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="754.4246"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="26" y="761.019">_get_item_block_int(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="769.4475"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="26" y="776.042">_get_item_block_list(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="784.4705"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="26" y="791.0649">_get_item_list_block(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="799.4934"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="26" y="806.0879">_get_item_list_list(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="814.5164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="26" y="821.1108">_get_item_list_int(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="829.5393"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="26" y="836.1338">_get_item_int_block(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="844.5623"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="26" y="851.1567">_get_item_int_list(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="859.5852"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="26" y="866.1797">_get_item_int_int(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="874.6082"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="218" x="26" y="881.2026">_getitem_exblock_exblock(saffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="889.6311"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="26" y="896.2256">_getitem_exblock_block(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="904.6541"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="26" y="911.2485">_getitem_exblock_list(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="919.677"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="26" y="926.2715">_getitem_exblock_int(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="934.7"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="26" y="941.2944">_getitem_list_exblock(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="949.7229"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="26" y="956.3174">_getitem_int_exblock(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="964.7458"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="26" y="971.3403">_getitem_block_exblock(scaffold_id, mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="979.7688"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="26" y="986.3633">_getitem_scaffold_int(scaffold_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="994.7917"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="26" y="1001.3862">_getitem_scaffold_list(scaffold_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1009.8147"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="179" x="26" y="1016.4092">_getitem_scaffold_block(scaffold_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1024.8376"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="26" y="1031.4321">_getitem_scaffold_exblock(scaffold_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1039.8606"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="26" y="1046.4551">_getitem_mol_int(mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1054.8835"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="119" x="26" y="1061.478">_getitem_mol_list(mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1069.9065"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="131" x="26" y="1076.501">_getitem_mol_block(mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1084.9294"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="26" y="1091.5239">_getitem_mol_exblock(mol_id)</text><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="14" y="1099.9524"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="26" y="1106.5469">_getitem_all()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="29" y="1121.5698"/><line style="stroke: #383838; stroke-width: 1.0;" x1="7" x2="161.5" y1="665.7869" y2="665.7869"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="161.5" y="670.3813">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="196.5" x2="351" y1="665.7869" y2="665.7869"/><!--class ProtoDataset--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="138.1377" id="ProtoDataset" style="stroke: #383838; stroke-width: 1.5;" width="182" x="387" y="712"/><ellipse cx="437.75" cy="728" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M437.4375,734 Q435.5,734 434.375,732.5703 Q433.25,731.1406 433.25,728.1875 Q433.25,725.6875 434.4375,724 Q435.625,722.3125 437.6875,722.3125 Q438.1406,722.3125 438.5781,722.3125 Q439.0156,722.3125 439.3281,722.3125 Q439.5781,722.3125 439.7422,722.3125 Q439.9063,722.3125 440.3125,722.3125 L441.0156,726 L439.9531,726 Q439.5156,724.9063 438.9453,724.4531 Q438.375,724 437.4531,724 Q436.2969,724 435.6172,725.1797 Q434.9375,726.3594 434.9375,728.1875 Q434.9375,730.2031 435.4609,731.2578 Q435.9844,732.3125 437.3906,732.3125 Q438.3125,732.3125 438.9609,731.7422 Q439.6094,731.1719 439.9531,729.7813 L440.9844,730.2969 Q440.5938,732.0469 439.6563,733.0234 Q438.7188,734 437.4375,734 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="458.25" y="733.5576">ProtoDataset</text><line style="stroke: #383838; stroke-width: 1.5;" x1="388" x2="568" y1="744" y2="744"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="393" y="760.606">A protocol buffer Dataset class</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="395" y="788.0574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="407" y="794.6519">scaffolds_proto_file</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="395" y="803.0803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="407" y="809.6748">idx_sm_proto_file</text><line style="stroke: #383838; stroke-width: 1.0;" x1="388" x2="468" y1="774.5344" y2="774.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="468" y="779.1289">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="488" x2="568" y1="774.5344" y2="774.5344"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="395" y="837.1262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="156" x="407" y="843.7207">__getitem__(scaffold_id, mol_id)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="388" x2="460.5" y1="823.6033" y2="823.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="460.5" y="828.1978">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="495.5" x2="568" y1="823.6033" y2="823.6033"/><!--class SQLSampler--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="303.3901" id="SQLSampler" style="stroke: #383838; stroke-width: 1.5;" width="388" x="604" y="629.5"/><ellipse cx="758.25" cy="645.5" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M757.9375,651.5 Q756,651.5 754.875,650.0703 Q753.75,648.6406 753.75,645.6875 Q753.75,643.1875 754.9375,641.5 Q756.125,639.8125 758.1875,639.8125 Q758.6406,639.8125 759.0781,639.8125 Q759.5156,639.8125 759.8281,639.8125 Q760.0781,639.8125 760.2422,639.8125 Q760.4063,639.8125 760.8125,639.8125 L761.5156,643.5 L760.4531,643.5 Q760.0156,642.4063 759.4453,641.9531 Q758.875,641.5 757.9531,641.5 Q756.7969,641.5 756.1172,642.6797 Q755.4375,643.8594 755.4375,645.6875 Q755.4375,647.7031 755.9609,648.7578 Q756.4844,649.8125 757.8906,649.8125 Q758.8125,649.8125 759.4609,649.2422 Q760.1094,648.6719 760.4531,647.2813 L761.4844,647.7969 Q761.0938,649.5469 760.1563,650.5234 Q759.2188,651.5 757.9375,651.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="778.75" y="651.0576">SQLSampler</text><line style="stroke: #383838; stroke-width: 1.5;" x1="605" x2="991" y1="661.5" y2="661.5"/><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="690.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="624" y="697.1289">dataset '传入dataset对象</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="705.5574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="624" y="712.1519">mode '有3种模式，training, test, evaluation，字符串识别</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="720.5803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="624" y="727.1748">batch_size</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="735.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="624" y="742.1978">num_mol '将self.dataset.num_mol传入，改了代码后好像用不到了</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="750.6262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="362" x="624" y="757.2207">num_scaffold '将self.dataset.num_scaffold传入，改了代码后好像用不到了</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="765.6492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="246" x="624" y="772.2437">block_id  '针对的fold，每次实例化一个新的sampler</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="780.6721"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="624" y="787.2666">ex</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="795.6951"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="624" y="802.2896">ids_sc_in</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="810.718"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="624" y="817.3125">ids_sc_ex</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="825.741"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="624" y="832.3354">ids_mol_in</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="840.7639"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="54" x="624" y="847.3584">idx_mol_ex</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="855.7869"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="624" y="862.3813">minibatch_size</text><line style="stroke: #383838; stroke-width: 1.0;" x1="605" x2="788" y1="677.0115" y2="677.0115"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="788" y="681.606">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="808" x2="991" y1="677.0115" y2="677.0115"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="612" y="889.8328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="624" y="896.4272">__init__(dataset, block_id, mode, batch_size)</text><ellipse cx="615" cy="907.8557" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="624" y="911.4502">__next__()</text><ellipse cx="615" cy="922.8787" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="624" y="926.4731">sample_by_idx(scaffold_id, mol_id, batch_size)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="605" x2="780.5" y1="876.3098" y2="876.3098"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="780.5" y="880.9043">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="815.5" x2="991" y1="876.3098" y2="876.3098"/><!--class ProtoSampler--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="183.2065" id="ProtoSampler" style="stroke: #383838; stroke-width: 1.5;" width="255" x="1027.5" y="689.5"/><ellipse cx="1112.75" cy="705.5" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1112.4375,711.5 Q1110.5,711.5 1109.375,710.0703 Q1108.25,708.6406 1108.25,705.6875 Q1108.25,703.1875 1109.4375,701.5 Q1110.625,699.8125 1112.6875,699.8125 Q1113.1406,699.8125 1113.5781,699.8125 Q1114.0156,699.8125 1114.3281,699.8125 Q1114.5781,699.8125 1114.7422,699.8125 Q1114.9063,699.8125 1115.3125,699.8125 L1116.0156,703.5 L1114.9531,703.5 Q1114.5156,702.4063 1113.9453,701.9531 Q1113.375,701.5 1112.4531,701.5 Q1111.2969,701.5 1110.6172,702.6797 Q1109.9375,703.8594 1109.9375,705.6875 Q1109.9375,707.7031 1110.4609,708.7578 Q1110.9844,709.8125 1112.3906,709.8125 Q1113.3125,709.8125 1113.9609,709.2422 Q1114.6094,708.6719 1114.9531,707.2813 L1115.9844,707.7969 Q1115.5938,709.5469 1114.6563,710.5234 Q1113.7188,711.5 1112.4375,711.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="1133.25" y="711.0576">ProtoSampler</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1028.5" x2="1281.5" y1="721.5" y2="721.5"/><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1035.5" y="750.5344"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="1047.5" y="757.1289">dataset</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1035.5" y="765.5574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="1047.5" y="772.1519">mode</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1035.5" y="780.5803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="1047.5" y="787.1748">batch_size</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1035.5" y="795.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="1047.5" y="802.1978">minibatch_size</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1028.5" x2="1145" y1="737.0115" y2="737.0115"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1145" y="741.606">filed</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1165" x2="1281.5" y1="737.0115" y2="737.0115"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1035.5" y="829.6492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="1047.5" y="836.2437">__init__(dataset, minibatch_size, batch_size=0)</text><ellipse cx="1038.5" cy="847.6721" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="1047.5" y="851.2666">__next__()</text><ellipse cx="1038.5" cy="862.6951" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="1047.5" y="866.2896">sample_by_idx(scaffold_id, mol_id, batch_size)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1028.5" x2="1137.5" y1="816.1262" y2="816.1262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1137.5" y="820.7207">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1172.5" x2="1281.5" y1="816.1262" y2="816.1262"/><!--class DFTransformer--><rect fill="#F8F8F8" filter="url(#fe0njc3egirjq)" height="303.3901" id="DFTransformer" style="stroke: #383838; stroke-width: 1.5;" width="165" x="1317.5" y="629.5"/><ellipse cx="1354.55" cy="645.5" fill="#C2C2C2" rx="11" ry="11" style="stroke: #383838; stroke-width: 1.0;"/><path d="M1354.2375,651.5 Q1352.3,651.5 1351.175,650.0703 Q1350.05,648.6406 1350.05,645.6875 Q1350.05,643.1875 1351.2375,641.5 Q1352.425,639.8125 1354.4875,639.8125 Q1354.9406,639.8125 1355.3781,639.8125 Q1355.8156,639.8125 1356.1281,639.8125 Q1356.3781,639.8125 1356.5422,639.8125 Q1356.7063,639.8125 1357.1125,639.8125 L1357.8156,643.5 L1356.7531,643.5 Q1356.3156,642.4063 1355.7453,641.9531 Q1355.175,641.5 1354.2531,641.5 Q1353.0969,641.5 1352.4172,642.6797 Q1351.7375,643.8594 1351.7375,645.6875 Q1351.7375,647.7031 1352.2609,648.7578 Q1352.7844,649.8125 1354.1906,649.8125 Q1355.1125,649.8125 1355.7609,649.2422 Q1356.4094,648.6719 1356.7531,647.2813 L1357.7844,647.7969 Q1357.3938,649.5469 1356.4563,650.5234 Q1355.5188,651.5 1354.2375,651.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="1373.45" y="651.0576">DFTransformer</text><line style="stroke: #383838; stroke-width: 1.5;" x1="1318.5" x2="1481.5" y1="661.5" y2="661.5"/><polygon fill="none" points="1328.5,688.5344,1332.5,692.5344,1328.5,696.5344,1324.5,692.5344" style="stroke: #8C8C8C; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="1337.5" y="697.1289">data</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="705.5574"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="1337.5" y="712.1519">col_sc_smiles</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="720.5803"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="1337.5" y="727.1748">col_mol_smiles</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="735.6033"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="1337.5" y="742.1978">col_ls_atom</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="750.6262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="1337.5" y="757.2207">col_ls_np</text><rect fill="none" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="765.6492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="1337.5" y="772.2437">col_ls_nh</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1318.5" x2="1390" y1="677.0115" y2="677.0115"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1390" y="681.606">field</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1410" x2="1481.5" y1="677.0115" y2="677.0115"/><rect fill="#808080" height="6" style="stroke: #595959; stroke-width: 1.0;" width="6" x="1325.5" y="799.6951"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="1337.5" y="806.2896">__init__(data,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="1337.5" y="821.3125">col_sc_smiles,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1337.5" y="836.3354">col_mol_smiles,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="1337.5" y="851.3584">col_ls_atom,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="1337.5" y="866.3813">col_ls_np,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="1337.5" y="881.4043">col_ls_nh)</text><ellipse cx="1328.5" cy="892.8328" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="1337.5" y="896.4272">mol_to_array(smiles)</text><ellipse cx="1328.5" cy="907.8557" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="1337.5" y="911.4502">mol_list_to_array(smiles_list)</text><ellipse cx="1328.5" cy="922.8787" fill="#A6A6A6" rx="3" ry="3" style="stroke: #545454; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="1337.5" y="926.4731">str_to_ls('[]')</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1318.5" x2="1382.5" y1="786.1721" y2="786.1721"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="1382.5" y="790.7666">method</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1417.5" x2="1481.5" y1="786.1721" y2="786.1721"/><!--link Object to Dataset--><path d="M1113.74,99.98 C969.441,141.183 709.654,215.358 571.053,254.931 " fill="none" id="Object-Dataset" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1112.15,93.16,1133.31,94.4,1116,106.62,1112.15,93.16" style="stroke: #383838; stroke-width: 1.0;"/><!--link Object to Sampler--><path d="M1132.53,144.453 C1115.38,159.473 1097.15,175.434 1079.42,190.953 " fill="none" id="Object-Sampler" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1127.96,139.155,1147.62,131.247,1137.18,149.688,1127.96,139.155" style="stroke: #383838; stroke-width: 1.0;"/><!--link Object to Transformer--><path d="M1217,151.394 C1217,174.457 1217,199.181 1217,220.817 " fill="none" id="Object-Transformer" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1210,151.247,1217,131.247,1224,151.247,1210,151.247" style="stroke: #383838; stroke-width: 1.0;"/><!--link Object to Block--><path d="M1291.31,145.522 C1310.69,165.091 1331.59,186.191 1351.01,205.796 " fill="none" id="Object-Block" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1286.27,150.382,1277.17,131.247,1296.22,140.53,1286.27,150.382" style="stroke: #383838; stroke-width: 1.0;"/><!--link Object to ExcludeBlock--><path d="M1319.73,98.98 C1385.05,119.46 1470.01,150.573 1539,191 C1544.77,194.383 1550.54,198.083 1556.24,201.994 " fill="none" id="Object-ExcludeBlock" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1317.63,105.66,1300.56,93.1,1321.73,92.28,1317.63,105.66" style="stroke: #383838; stroke-width: 1.0;"/><!--link Dataset to SQLDataset--><path d="M414.137,367.79 C398.823,389.043 382.892,412.062 369,434 C363.409,442.83 357.81,451.835 352.223,460.964 " fill="none" id="Dataset-SQLDataset" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="408.527,363.602,425.959,351.555,419.845,371.843,408.527,363.602" style="stroke: #383838; stroke-width: 1.0;"/><!--link Dataset to ProtoDataset--><path d="M478,371.895 C478,469.137 478,623.321 478,711.711 " fill="none" id="Dataset-ProtoDataset" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="471,371.755,478,351.755,485,371.755,471,371.755" style="stroke: #383838; stroke-width: 1.0;"/><!--link Sampler to SQLSampler--><path d="M936.65,393.26 C911.767,462.666 879.271,553.309 851.993,629.395 " fill="none" id="Sampler-SQLSampler" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="930.117,390.741,943.456,374.277,943.295,395.466,930.117,390.741" style="stroke: #383838; stroke-width: 1.0;"/><!--link Sampler to ProtoSampler--><path d="M1015.57,393.264 C1047.64,482.211 1092.28,606.038 1122.34,689.403 " fill="none" id="Sampler-ProtoSampler" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1008.93,395.466,1008.73,374.277,1022.1,390.717,1008.93,395.466" style="stroke: #383838; stroke-width: 1.0;"/><!--link Transformer to DFTransformer--><path d="M1264.52,361.855 C1277.13,384.614 1290,409.855 1300,434 C1325.84,496.391 1347.68,567.72 1364.29,629.341 " fill="none" id="Transformer-DFTransformer" style="stroke: #383838; stroke-width: 1.0;"/><polygon fill="none" points="1258.28,365.055,1254.52,344.202,1270.47,358.156,1258.28,365.055" style="stroke: #383838; stroke-width: 1.0;"/><!--
@startuml

skinparam dpi 300
skinparam monochrome true
skinparam svgLinkTarget _parent


abstract class Object

Object <|- - Dataset

Object <|- - Sampler

Object <|- - Transformer

Object <|- - Block

Object <|- - ExcludeBlock



Dataset <|- - SQLDataset
Dataset <|- - ProtoDataset

Sampler <|- - SQLSampler
Sampler <|- - ProtoSampler

Transformer <|- - DFTransformer

class Object{
Parent class of all other classes
- -field- -
(buitin)
- -method- -
(builtin)
}



class Block{
A subclass of int
Performs the id of a block of samples
- -filed- -
-num
- -method- -
-__init__(block_id)
-__repr__()
}

class ExcludeBlock{
- -filed- -
-block_id
- i
-ls_all
- -method- -
-__init__(block_id, num_block=5)
-__repr__()
-__iter__()
-__next__()
}

abstract class Dataset{
The whole data will be exposed to it
- -filed- -

- -method- -
#__init__()
#__getitem__(*input)
}

class SQLDataset{
A mysql Dataset class
- -field- -
-db
-scaffold_table
-mol_table
-map_table
-num_mol
-num_scaffold
-num_map
-sc_fold 'dict {block_id:[mol,mol]} 直接初始时运行好，只花一次时间
-mol_fold 'dict {block_id:[mol, mol]}
-num_fold=5 '预置fold数
- -method- -
-__init__(mysql_param, scaffold_table, mol_table, map_table)
+ls_to_str(list) '把传入的列表转为'(int,int...)'的字符串形式
-__getitem__(scaffold_id, mol_id) '对应5*5=25种索引方式

-_get_item_block_block(scaffold_id, mol_id)
-_get_item_block_int(scaffold_id, mol_id)
-_get_item_block_list(scaffold_id, mol_id)
-_get_item_list_block(scaffold_id, mol_id)
-_get_item_list_list(scaffold_id, mol_id)
-_get_item_list_int(scaffold_id, mol_id)
-_get_item_int_block(scaffold_id, mol_id)
-_get_item_int_list(scaffold_id, mol_id)
-_get_item_int_int(scaffold_id, mol_id)
-_getitem_exblock_exblock(saffold_id, mol_id)
-_getitem_exblock_block(scaffold_id, mol_id)
-_getitem_exblock_list(scaffold_id, mol_id)
-_getitem_exblock_int(scaffold_id, mol_id)
-_getitem_list_exblock(scaffold_id, mol_id)
-_getitem_int_exblock(scaffold_id, mol_id)
-_getitem_block_exblock(scaffold_id, mol_id)
-_getitem_scaffold_int(scaffold_id)
-_getitem_scaffold_list(scaffold_id)
-_getitem_scaffold_block(scaffold_id)
-_getitem_scaffold_exblock(scaffold_id)
-_getitem_mol_int(mol_id)
-_getitem_mol_list(mol_id)
-_getitem_mol_block(mol_id)
-_getitem_mol_exblock(mol_id)
-_getitem_all()

}

class ProtoDataset{
A protocol buffer Dataset class
- -filed- -
-scaffolds_proto_file
-idx_sm_proto_file
- -method- -
-__getitem__(scaffold_id, mol_id)
}


abstract class Sampler{
A generator of mini-batch
- -field- -
#dataset
#mode
#batch_size
- -method- -
#__init__(dataset, batch_size, mini_batch_size)
+__next__()
+sample_by_idx(scaffold_id, mol_id, batch_size)
}

class SQLSampler{
- -filed- -
-dataset '传入dataset对象
-mode '有3种模式，training, test, evaluation，字符串识别
-batch_size
-num_mol '将self.dataset.num_mol传入，改了代码后好像用不到了
-num_scaffold '将self.dataset.num_scaffold传入，改了代码后好像用不到了
-block_id  '针对的fold，每次实例化一个新的sampler
-ex
-ids_sc_in
-ids_sc_ex
-ids_mol_in
-idx_mol_ex
-minibatch_size
- -method- -
-__init__(dataset, block_id, mode, batch_size)
+__next__()
+sample_by_idx(scaffold_id, mol_id, batch_size)
}

class ProtoSampler{
- -filed- -
-dataset
-mode
-batch_size
-minibatch_size
- -method- -
-__init__(dataset, minibatch_size, batch_size=0)
+__next__()
+sample_by_idx(scaffold_id, mol_id, batch_size)
}



abstract class Transformer{
- -field- -
#data
- -method- -
#mol_to_array(smiles)
#batch_to_array(smiles_list)
}

class DFTransformer{
- -field- -
#data
-col_sc_smiles
-col_mol_smiles
-col_ls_atom
-col_ls_np
-col_ls_nh
- -method- -
-__init__(data,
          col_sc_smiles,
          col_mol_smiles,
          col_ls_atom,
          col_ls_np,
          col_ls_nh)
+mol_to_array(smiles)
+mol_list_to_array(smiles_list)
+str_to_ls('[]')
}



@enduml

PlantUML version 1.2018.11(Sun Sep 23 00:43:53 CST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b16
Operating System: Windows 10
OS Version: 10.0
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>